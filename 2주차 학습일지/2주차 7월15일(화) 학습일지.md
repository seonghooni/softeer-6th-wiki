# 1. ë¦¬ë·° 
### :laughing: ì˜¤ëŠ˜ í•œ ì‘ì—…




#### 1. ê°œë°œ ê³¼ì œ ìˆ˜í–‰

ì˜¤ëŠ˜ì€ 2ì£¼ì°¨ ë¦¬íŒ©í† ë§ ì‘ì—…ì„ ì§„í–‰í–ˆë‹¤.

- HttpMethodë¼ëŠ” ì´ë¦„ìœ¼ë¡œ, Http Methodì˜ ë¬¸ìì—´ ìƒìˆ˜ë¥¼ ê´€ë¦¬í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ì‘ì„±í–ˆë‹¤.
- ì½”ë“œë¥¼ ì „ë°˜ì ìœ¼ë¡œ ì½ì–´ ë³´ë©°, ë¶ˆí•„ìš”í•˜ê²Œ ì¤‘ë³µëœ ë¶€ë¶„ì„ ì œê±°í–ˆë‹¤.
- path, methodì— ëŒ€í•´ ì¤‘ì²©ëœ ifë¬¸ìœ¼ë¡œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ë˜ ì½”ë“œë¥¼ ë¦¬íŒ©í† ë§í–ˆë‹¤.
- HttpRequestRouter í´ë˜ìŠ¤ë¥¼ ìƒì„±í–ˆê³ , HashMapì„ ì´ìš©í•´ ì ì ˆí•œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ì•„ë‚´ë„ë¡ í–ˆë‹¤.
- ìƒíƒœë¥¼ ì €ì¥í•˜ì§€ ì•Šê³  ë§¤ë²ˆ ìƒì„±í•´ì¤„ í•„ìš”ê°€ ì—†ëŠ” í´ë˜ìŠ¤ëŠ” WebServerContextì—ì„œ ê´€ë¦¬í•˜ë„ë¡ í–ˆë‹¤.
- ì½”ë“œì˜ ì¬ì‚¬ìš©ì„±ì„ ìœ„í•´ bodyì˜ formDataë¥¼ íŒŒì‹±í•´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±í–ˆë‹¤.
- ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ ì¼ë¶€ êµ¬í˜„í•˜ë‹¤ê°€ ë§ˆë¬´ë¦¬í–ˆë‹¤.


<br>

### :dizzy: ì‘ì—… ê³¼ì •ì—ì„œì˜ ë°°ìš´ ê²ƒ
**DIì˜ ì¥ì ì— ëŒ€í•´ ë°°ì› ë‹¤.**

ì´ˆê¸°ì— ì‘ì—…í–ˆë˜ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì•˜ë‹¤.

(ë§¤ë²ˆ ê°ì²´ë¥¼ ì´ˆê¸°í™”í•´ì£¼ë˜ ê³¼ì •ì„ ê°œì„ í•˜ê¸° ìœ„í•´ WebServerContextë¡œ static ê°ì²´ë“¤ì„ ê´€ë¦¬í•˜ê³ ì í–ˆë‹¤.)

```
public class WebServerContext {

    private static final HttpRequestRouter router = new HttpRequestRouter();
    private static final HttpRequestBuilder requestBuilder = new HttpRequestBuilder();
    private static final HttpResponseWriter responseWriter = new HttpResponseWriter();
    private static final HttpResponseBuilder responseBuilder = new HttpResponseBuilder();
    private static final StaticResourceHandler staticResourceHandler = new StaticResourceHandler();

    static {
        router.register("/users/create", HttpMethod.POST, new UserController()::handleCreate);
    }

    public static HttpRequestRouter getRouter() {
        return router;
    }

    public static HttpRequestBuilder getRequestBuilder() {
        return requestBuilder;
    }
       ...
```
```
public class HttpRequestRouter {

    private final Map<String, Map<String, Function<HttpRequest, HttpResponse>>> routes = new HashMap<>();

    private final HttpResponseBuilder responseBuilder = WebServerContext.getResponseBuilder();
    private final StaticResourceHandler staticResourceHandler =
                                                  WebServerContext.getStaticResourceHandler();

```
í•˜ì§€ë§Œ ì´ ì½”ë“œëŠ” ì‹¬ê°í•œ ë¬¸ì œê°€ ìˆë‹¤.
ë°”ë¡œ Null-safeë¥¼ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì´ë‹¤.

ì‹¤ì œë¡œ ì‹¤í–‰í–ˆì„ ë•Œ `NullPointerException`ì´ ë°œìƒí–ˆëŠ”ë°, ê·¸ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- `WebServerContext`ì˜ static ë¸”ë¡ì—ì„œ `UserController`ë¥¼ ìƒì„±í•˜ëŠ” ì‹œì ì—,
- `HttpRequestRouter` ë‚´ë¶€ì—ì„œ `WebServerContext`ë¥¼ ì°¸ì¡°í•˜ê²Œ ë˜ì—ˆê³ ,
- ì´ ê³¼ì •ì—ì„œ `WebServerContext` ë‚´ë¶€ ì •ì  í•„ë“œê°€ ì™„ì „íˆ ì´ˆê¸°í™”ë˜ì§€ ì•Šì€ ìƒíƒœë¡œ ì ‘ê·¼ë˜ë©´ì„œ nullì´ ì „ë‹¬ë˜ì—ˆë‹¤.

**ì¦‰, ê°ì²´ ê°„ ì˜ì¡´ ìˆœí™˜ ë¬¸ì œê°€ ë°œìƒí–ˆê³ , ì´ëŠ” static ë°©ì‹ë§Œìœ¼ë¡œëŠ” ì•ˆì „í•˜ê²Œ ì´ˆê¸°í™” ìˆœì„œë¥¼ ì œì–´í•  ìˆ˜ ì—†ë‹¤ëŠ” í•œê³„ë¥¼ ë³´ì—¬ì£¼ì—ˆë‹¤.**

ì´ëŸ¬í•œ ë°©ì‹ì€ ì°¸ì¡° ë³€ìˆ˜ê°€ nullì¸ì§€ ì•„ë‹Œì§€ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ì•Œ ìˆ˜ ì—†ê³ ,

ê·¸ë ‡ë‹¤ê³  í•´ì„œ ëŸ°íƒ€ì„ì—ì„œ null-safeê°€ ë³´ì¥ë˜ëŠ” ê²ƒë„ ì•„ë‹ˆë‹¤.

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë©´ì„œ ì‹±ê¸€í†¤ íŒ¨í„´ê³¼ DIì˜ ì¤‘ìš”ì„±ì— ëŒ€í•´ ë‹¤ì‹œê¸ˆ ìƒê°í•˜ê²Œ ë˜ì—ˆë‹¤.

<br><br>


**ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì¡°ë¥¼ ë³€ê²½í–ˆë‹¤:**

WebServerContextëŠ” ì§ì ‘ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ìƒì„±ìì— ëª…ì‹œì ìœ¼ë¡œ ì˜ì¡´ ê°ì²´ë¥¼ ì£¼ì…(DI) í•˜ë„ë¡ ë³€ê²½

-> ì´ë¥¼ í†µí•´ ì´ˆê¸°í™” ìˆœì„œê°€ ì˜ëª»ë˜ì—ˆëŠ”ì§€ ì»´íŒŒì¼ ì‹œì ì— í™•ì¸í•  ìˆ˜ ìˆìŒ

```
public class WebServerContext {

    private static final HttpResponseBuilder responseBuilder = new HttpResponseBuilder();
    private static final StaticResourceHandler staticResourceHandler = new StaticResourceHandler(responseBuilder);
    private static final HttpRequestRouter router = new HttpRequestRouter(staticResourceHandler, responseBuilder);

    static {
        router.register("/users/create", HttpMethod.POST,
            new UserController(staticResourceHandler, responseBuilder)::handleCreate);
    }
}

```

```
public class HttpRequestRouter {

    private final Map<String, Map<String, Function<HttpRequest, HttpResponse>>> routes = new HashMap<>();

    private final StaticResourceHandler staticResourceHandler;
    private final HttpResponseBuilder responseBuilder;

    public HttpRequestRouter(StaticResourceHandler handler, HttpResponseBuilder builder) {
        this.staticResourceHandler = handler;
        this.responseBuilder = builder;
    }
```

DIë¥¼ ì‚¬ìš©í•˜ë©´ ê°ì²´ ê°„ì˜ ì˜ì¡´ ê´€ê³„ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ì˜ëª»ëœ ì´ˆê¸°í™” ìˆœì„œë‚˜ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œë¥¼ ì˜ˆë°©í•  ìˆ˜ ìˆë‹¤.

ì´ê²ƒì´ DIì˜ ì¥ì ì´ëƒ? ë¼ê³  í•˜ê¸°ì—ëŠ” DIì˜ ë‹¤ë¥¸ ì¥ì ì´ ë„ˆë¬´ í¬ë¦¬í‹°ì»¬í•˜ì§€ë§Œ,

ìµœì†Œí•œ SpringBootì—ì„œ ì•Œì•„ì„œ ê´€ë¦¬í•´ì£¼ë˜ ë¹ˆ ì£¼ì…ì„ ë‚´ê°€ ì§ì ‘ êµ¬í˜„í•˜ëŠ” ê³¼ì •ì—ì„œëŠ”

ì‹¤ìˆ˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆëŠ” ë°©ì•ˆìœ¼ë¡œì„œ ì¥ì ì„ ê°–ê³  ìˆë‹¤ê³  ìƒê°í•œë‹¤.



<br>


### :sob: ì–´ë ¤ì› ë˜ ì 

ì•ì„  ì‘ì—… ê³¼ì •ì—ì„œ ë°°ì› ë‹¤ê³ ëŠ” í•˜ì§€ë§Œ, ì´ ì½”ë“œê°€ ê³¼ì—° ì˜³ì€ ê²ƒì¸ê°€? ì— ëŒ€í•´ì„œëŠ” ê³„ì† ì˜ë¬¸ì´ ìƒê¸´ë‹¤.

ë­”ê°€ ë” ê°œì„ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ìˆì„ ê²ƒ ê°™ê³ , ë‚´ í˜„ì¬ ì½”ë“œì—ì„œì˜ ë¬¸ì œì ì´ ìˆì„ ê²ƒ ê°™ì•„ ê³„ì† ì°¾ì•„ë´¤ì§€ë§Œ

ëª…í™•í•˜ê²Œ íŒë‹¨ì´ ì„œì§€ ì•Šì•˜ë‹¤.

ì´ ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” ê·¸ë£¹ì›ë“¤ê³¼ ì½”ë“œë¦¬ë·°ë¥¼ í†µí•´ í”¼ë“œë°±ì„ í•œ ë²ˆ ë°›ì•„ë³´ê³  ì‹¶ë‹¤.


<br><br>



# 2. íšŒê³  (KPT)

âœ… **K â€“ Keep (ìœ ì§€í•  ê²ƒ)**

**ì¤‘ë³µë  ê²ƒ ê°™ì€ ì½”ë“œì— ëŒ€í•´ì„œ, ì¬ì‚¬ìš©ì„±ê³¼ í™•ì¥ì„±ì— ëŒ€í•´ ê³„ì†í•´ì„œ ê³ ë¯¼í•˜ëŠ” ê²ƒì€ ì¢‹ì•˜ë‹¤ê³  ìƒê°í•œë‹¤.**

ì•ìœ¼ë¡œë„ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ì„œ, ìì£¼ ì“°ì¼ ê²ƒ ê°™ê±°ë‚˜ ê°œì„ í•  ê²ƒì— ëŒ€í•´ì„œ ì§€ì†ì ìœ¼ë¡œ ê³ ë¯¼í•˜ê² ë‹¤.  <br><br>

**ì§€ë‚œì£¼ í”¼ë“œë°±ì„ ë°”íƒ•ìœ¼ë¡œ, ì´ë²ˆë¶€í„°ëŠ” ì»¤ë°‹ì„ ì˜ê²Œ ìª¼ê°œëŠ” ìŠµê´€ì„ ë“¤ì˜€ë‹¤.**

ë‚´ ì»¤ë°‹ì„ ë‚´ê°€ ë³´ëŠ” ê²ƒì´ì§€ë§Œ,

í™•ì‹¤íˆ ì´ì „ë³´ë‹¤, ì»¤ë°‹ ë¡œê·¸ë¥¼ ëŒì•„ë³¼ ë•Œ í›¨ì”¬ ì§ê´€ì ì´ê³  ë³€ê²½ì‚¬í•­ì„ íŒŒì•…í•˜ê¸°ê°€ ì‰¬ì›Œì¡Œë‹¤.

<br>

ğŸ› ï¸ **P â€“ Problem (ê°œì„ ì´ í•„ìš”í•œ ì )**

ë°˜ë©´, ë„ˆë¬´ ê°œì„  ë°©ì•ˆì— ëŒ€í•´ì„œë§Œ ê³ ë¯¼í•˜ë‹¤ ë³´ë‹ˆ ì½”ë“œ ê°œë°œ ì†ë„ê°€ ë§ì´ ëŠë¦° ê²ƒ ê°™ë‹¤.

**ì´ë ‡ê²Œ ê³ ë¯¼ì—ì„œ ë„ˆë¬´ ë§‰í ë•Œì—ëŠ” ì°¨ë¼ë¦¬ ì½”ë“œë¥¼ ì¼ë‹¨ ì‘ì„±í•´ë³´ê³ , ë¹„íš¨ìœ¨ì„ ì²´ê°í•˜ëŠ” ì‹œê¸°ê°€ ì˜¤ë©´ ê·¸ ë•Œ ë¦¬íŒ©í† ë§ì„ í•´ë³´ëŠ” ê²ƒì´ ì–´ë–¨ê¹Œ ì‹¶ë‹¤.**

<br>

ğŸ”„ **T â€“ Try (ì‹œë„í•  ê²ƒ)**

ì‚¬ìš©ìì˜ ìš”ì²­ì— ëŒ€í•´ ì²˜ë¦¬í•  í•¨ìˆ˜ë¥¼ íƒìƒ‰í•˜ëŠ” ë³€ìˆ˜ê°€ ë‹¤ìŒê³¼ ê°™ì´ ë˜ì–´ìˆë‹¤.


`private final Map<String, Map<String, Function<HttpRequest, HttpResponse>>> routes = new HashMap<>();`

ì´ì „ë³´ë‹¤ëŠ” ê°œì„ ë˜ì—ˆë‹¤ê³  ìƒê°í•˜ì§€ë§Œ, ì ì ˆí•œ í•¨ìˆ˜ë¥¼ ì°¾ëŠ” ê³¼ì •ì—ì„œ

routes.get("path"), ë˜ í•œë²ˆ get("method") ë¥¼ ì§„í–‰í•´ì•¼ í•œë‹¤.

ë¹„íš¨ìœ¨ì ì¸ ì‘ì—…ì¸ ê²ƒ ê°™ì•„. <Path, Method>ë¥¼ ê°–ëŠ” ê°ì²´ë¥¼ Keyê°’ìœ¼ë¡œ ë¼ìš°íŒ…ì„ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ê³ ë¯¼í•´ë³´ê³ 

ì¥ë‹¨ì ì„ í•œë²ˆ ë¹„êµí•´ë³´ë ¤ê³  í•œë‹¤.


<br><br>

# 3. í•™ìŠµ ë‚´ìš©

ğŸ”¹ **Springì´ ì í•©í•œ handlerë¥¼ ì°¾ëŠ” ë°©ì‹ê³¼ Tomcatì´ ì í•©í•œ controllerë¥¼ ì°¾ëŠ” ë°©ì‹ì˜ ì°¨ì´**

ì´ë²ˆ ì£¼ ì•ˆì— ì™„ë²½íˆ ìˆ™ì§€í•˜ì—¬ ì •ë¦¬ë‚´ìš©ì„ ì—…ë¡œë“œí•˜ë„ë¡ í•˜ê² ë‹¤.

